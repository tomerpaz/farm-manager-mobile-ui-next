{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/tomer/VSCodeProjects/farm-manager-mobile-ui-next/src/ui/scout/ScoutingForm.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport Button from '@mui/material/Button';\nimport Dialog from '@mui/material/Dialog';\nimport { AppBar, Autocomplete, Box, DialogActions, DialogContent, IconButton, MenuItem, Slide, TextField, Toolbar, Typography } from '@mui/material';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { selectLang, setSnackbar } from '../../features/app/appSlice';\nimport TextFieldBase from '../../components/ui/TextField';\nimport { useGetUserDataQuery } from '../../features/auth/authApiSlice';\nimport { Controller, useForm } from 'react-hook-form';\nimport { Close, Delete, Save } from '@mui/icons-material';\nimport { getYearArray, isMobile, UI_SIZE } from '../FarmUtil';\nimport { useGetInfectionLevelsQuery, useGetPestsQuery, useGetPestStagesQuery, useGetPlantLocationsQuery } from '../../features/pests/pestsApiSlice';\nimport { DatePicker } from '@mui/x-date-pickers';\nimport { useCreateFieldScoutMutation, useDeleteFieldScoutMutation, useUpdateFieldScoutMutation } from '../../features/scout/scoutsApiSlice';\nimport ActionApprovalDialog from '../../components/ui/ActionApprovalDialog';\n\n\nconst Transition = React.forwardRef(function Transition(props, ref) {\n  return <Slide direction=\"up\" ref={ref} {...props} />;\n});\n\nconst ScoutingForm = ({ defaultValues, open, handleClose }) => {\n\n  const text = useSelector(selectLang)\n\n  const { data: user } = useGetUserDataQuery()\n\n  const { data: pests, isLoading: isPestsLoading } = useGetPestsQuery();\n  const { data: infectionLevels } = useGetInfectionLevelsQuery()\n  const { data: stages } = useGetPestStagesQuery()\n  const { data: plantLocations } = useGetPlantLocationsQuery()\n  const [deleteOpen, setDeleteOpen] = useState(false);\n\n  const [createFieldScout] = useCreateFieldScoutMutation();\n  const [updateFieldScout] = useUpdateFieldScoutMutation()\n  const [deleteFieldScout] = useDeleteFieldScoutMutation()\n\n  const dispatch = useDispatch()\n\n  const { control, register, handleSubmit, getValues, watch, formState: { errors },\n    formState: { isDirty, dirtyFields }, reset, setValue, trigger\n  } = useForm({ defaultValues });\n\n\n  const saveFieldScout = (data) => {\n    console.log('saveFieldScout', data)\n    if (data.id === null) {\n      return createFieldScout(data).unwrap();\n    } else {\n      return updateFieldScout(data).unwrap();\n    }\n  }\n\n  const onSubmit = async (data) => {\n    try {\n      const result = await saveFieldScout(data);\n\n      dispatch(setSnackbar({ msg: data.id ? text.recordUpdated : text.recordCreated, severity: 'success' }))\n      handleClose(true);\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  const handleDelete = (value) => {\n    setDeleteOpen(false)\n    if (value) {\n      deleteFieldScout({ id: defaultValues.id });\n      handleClose(false);\n      dispatch(setSnackbar({ msg: text.recordDeleted }))\n    }\n  }\n  return (\n\n    <Dialog fullScreen={isMobile()} fullWidth={!isMobile()} open={open} /*TransitionComponent={Transition}*/ >\n      <AppBar sx={{ position: 'relative' }} elevation={0}>\n        <Toolbar>\n          <Typography sx={{ ml: 2, flex: 1 }} variant=\"h6\" component=\"div\">\n            {text.scouting}\n          </Typography>\n          <IconButton\n            edge=\"start\"\n            onClick={() => handleClose(false)}\n            color=\"inherit\"\n            aria-label=\"done\"\n          >\n            <Close />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <form onSubmit={handleSubmit(onSubmit)} >\n\n        <DialogContent>\n          {/* <DialogContentText>\n          {`${text.field} ${fieldName}`}\n        </DialogContentText> */}\n          <Box display={'flex'} flexDirection={'row'} alignItems={'center'}>\n\n\n            <Controller\n              name=\"date\"\n              control={control}\n              render={({ field }) =>\n                <DatePicker label={text.date}\n                  closeOnSelect\n                  showToolbar={false}\n                  rules={{ required: true }}\n\n                  localeText={{\n                    cancelButtonLabel: text.cancel,\n                    okButtonLabel: text.save\n                  }}\n                  slotProps={{\n                    textField: { size: UI_SIZE, variant: 'outlined', sx: { flex: 1 } },\n                    actionBar: { actions: [\"cancel\" /*, \"clear\"*/] }\n                  }}\n                  {...field} />}\n            />\n\n            <Box margin={1} />\n            <Controller\n              control={control}\n              name=\"year\"\n              rules={{ required: true }}\n              render={({ field }) => (\n                <TextField\n                  id=\"scout-select-year\"\n                  select\n                  sx={{ flex: 1 }}\n                  {...field}\n                  size={UI_SIZE}\n                  label={text.year}\n                >\n                  <MenuItem value={0}>{text.perennial}</MenuItem>\n                  {getYearArray().map((option) => (\n                    <MenuItem key={option} value={option}>\n                      {option}\n                    </MenuItem>\n                  ))}\n                </TextField>\n              )}\n            />\n          </Box>\n          <Box marginTop={2} display={'flex'} flexDirection={'row'} alignItems={'center'}>\n\n            <Controller\n              name=\"finding\"\n              control={control}\n              rules={{ required: true }}\n              render={({ field: { ref, onChange, ...field } }) => <Autocomplete\n                // disablePortal\n                blurOnSelect={true}\n                onChange={(_, data) => onChange(data)}\n                options={pests}\n                sx={{ flex: 3 }}\n                size={UI_SIZE}\n                getOptionLabel={(option) => option ? option.name : ''}\n                isOptionEqualToValue={(option, value) => (value === undefined) || option?.id?.toString() === (value?.id ?? value)?.toString()}\n                renderInput={(params) => <TextFieldBase\n                  error={errors.finding ? true : false}\n                  sx={{ marginTop: 0.5 }} {...params} label={text.pest} />}\n                {...field} />}\n            />\n          </Box>\n          {/* <Controller\n            name=\"location\"\n            control={control}\n            rules={{ required: true }}\n            render={({ field: { ref, onChange, ...field } }) => <Autocomplete\n              // disablePortal\n              onChange={(_, data) => onChange(data)}\n              options={plantLocations}\n              // sx={{ flex: 1.6 }}\n              // fullWidth\n              size={UI_SIZE}\n              getOptionLabel={(option) => option ? option.name : ''}\n              isOptionEqualToValue={(option, value) => (value === undefined) || option?.id?.toString() === (value?.id ?? value)?.toString()}\n              renderInput={(params) => <TextFieldBase  {...params} label={text.location} />}\n              {...field} />}\n          /> */}\n\n          <Box marginTop={2} display={'flex'} flexDirection={'row'} alignItems={'center'}>\n            <Controller\n              control={control}\n              name=\"location\"\n              render={({ field }) => (\n                <TextField\n                  id=\"scout-location\"\n                  select\n                  {...field}\n                  size={UI_SIZE}\n                  label={text.location}\n                  fullWidth\n                >\n                  {plantLocations.map((option) => (\n                    <MenuItem key={option} value={option}>\n                      {text[option]}\n                    </MenuItem>\n                  ))}\n                </TextField>\n              )}\n            />\n            <Box margin={1} />\n\n            <Controller\n              control={control}\n              name=\"infectionLevel\"\n              render={({ field }) => (\n                <TextField\n                  id=\"scout-infectionLevel\"\n                  select\n                  {...field}\n                  size={UI_SIZE}\n                  label={text.infectionLevel}\n                  fullWidth\n                >\n                  {infectionLevels.map((option) => (\n                    <MenuItem key={option} value={option}>\n                      {text[option]}\n                    </MenuItem>\n                  ))}\n                </TextField>\n              )}\n            />\n          </Box>\n          <Box marginTop={1} display={'flex'} flexDirection={'row'} alignItems={'center'}>\n            <Controller\n              control={control}\n              name=\"stage.id\"\n              render={({ field }) => (\n                <TextField\n                  id=\"scout-pest-stage\"\n                  select\n                  {...field}\n                  size={UI_SIZE}\n                  label={text.phenologicalStage}\n                  fullWidth\n                >\n                  {stages.map((option) => (\n                    <MenuItem key={option.id} value={option.id}>\n                      {option.name}\n                    </MenuItem>\n                  ))}\n                </TextField>\n              )}\n            />\n            <Box margin={1} />\n\n            <Controller\n              control={control}\n              name=\"value\"\n              render={({ field: { ref, ...field } }) => (\n                <TextFieldBase\n                  type='number'\n                  id=\"scout-value\"\n                  size={UI_SIZE}\n                  label={text.qty} fullWidth {...field} />\n              )}\n            />\n          </Box>\n          <Box marginTop={1} display={'flex'} flexDirection={'row'} alignItems={'center'}>\n            <Controller\n              control={control}\n              name=\"note\"\n              render={({ field: { ref, ...field } }) => (\n                <TextFieldBase\n                  id=\"scout-note\"\n                  size={UI_SIZE}\n                  multiline rows={2}\n                  label={text.note} fullWidth {...field} />\n              )}\n            />\n          </Box>\n\n\n\n\n\n        </DialogContent>\n        <DialogActions sx={{ justifyContent: 'center' }}>\n          {defaultValues.id && <Button size='large' endIcon={<Delete />} variant='outlined' onClick={() => setDeleteOpen(true)}>{text.delete}</Button>}\n          <Button size='large' disabled={!isDirty} endIcon={<Save />} disableElevation={true} variant='contained' type=\"submit\" >\n            {text.save}\n          </Button>\n        </DialogActions>\n      </form >\n      <ActionApprovalDialog open={deleteOpen} handleClose={handleDelete}\n        title={text.deleteFormTitle} body={text.deleteFormBody} okText={text.delete} cancelText={text.cancel} />\n\n    </Dialog>\n  );\n\n}\nexport default ScoutingForm;\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 690, "column": 0}, "map": {"version":3,"sources":["file:///home/tomer/VSCodeProjects/farm-manager-mobile-ui-next/src/ui/scout/ScoutingUtil.js"],"sourcesContent":["import { isArrayEmpty, newDate } from \"../FarmUtil\";\n\nexport const infectionLevels = [{ level: 'high', color: '#f44336', dark: '#b71c1c' },\n{ level: 'medium', color: '#ff8f00', dark: '#e65100' },\n{ level: 'low', color: '#ffeb3b', dark: '#f57f17' },\n{ level: 'none', color: '#7cb342', dark: '#1b5e20' }]\n\n\nexport const SCOUT_TYPES = ['scouting', 'trap'];\n\nexport function getInfectionLevelColor(infectionLevel, perimeter, type) {\n    const level = infectionLevels.find(level => infectionLevel === level.level);\n    if (level) {\n        if (perimeter && type === 'trap') {\n            return 'black'\n        } else {\n            return perimeter ? level.dark : level.color;\n        }\n    }\n}\nexport function getPestMonitorInfectionLevelColor(pestMonitors, dark) {\n    let color = null;\n    infectionLevels.forEach(level => {\n        let val = pestMonitors.find(pm => pm.infectionLevel === level.level);\n        if (!color && val) {\n            color = dark ? level.dark : level.color;\n        }\n    })\n    return color;\n}\n\n\nexport function getPointColor(point, scouts, dark) {\n    if (point.active === false) {\n        return dark && point.type === 'trap' ? 'black' : 'gray';\n    } else if (isArrayEmpty(scouts)) {\n        return dark && point.type === 'trap' ? 'black' : 'white';\n    } else {\n        const level = scouts[0].infectionLevel\n        return getInfectionLevelColor(level, dark, point.type);\n    }\n\n}\n\nexport function buildScoutPoints(points, scouts) {\n    return points?.map(e => {\n\n        const fieldScouts = scouts?.filter(s => s.point.id === e.id)\n        const val = { ...e, color: getPointColor(e, fieldScouts, true), fillColor: getPointColor(e, fieldScouts, false) }\n        return val;\n    });\n}\n\nexport function newScouting(point, stages, currentYear) {\n    return { id: null, point: point, date: newDate(), note: '', finding: null, location: 'none', infectionLevel: \"none\", value: '', year: currentYear, stage: stages[0] }\n\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;;;;;AAEO,IAAM,kBAAkB;IAAC;QAAE,OAAO;QAAQ,OAAO;QAAW,MAAM;IAAU;IACnF;QAAE,OAAO;QAAU,OAAO;QAAW,MAAM;IAAU;IACrD;QAAE,OAAO;QAAO,OAAO;QAAW,MAAM;IAAU;IAClD;QAAE,OAAO;QAAQ,OAAO;QAAW,MAAM;IAAU;CAAE;AAG9C,IAAM,cAAc;IAAC;IAAY;CAAO;AAExC,SAAS,uBAAuB,cAAc,EAAE,SAAS,EAAE,IAAI;IAClE,IAAM,QAAQ,gBAAgB,IAAI,CAAC,SAAA;eAAS,mBAAmB,MAAM,KAAK;;IAC1E,IAAI,OAAO;QACP,IAAI,aAAa,SAAS,QAAQ;YAC9B,OAAO;QACX,OAAO;YACH,OAAO,YAAY,MAAM,IAAI,GAAG,MAAM,KAAK;QAC/C;IACJ;AACJ;AACO,SAAS,kCAAkC,YAAY,EAAE,IAAI;IAChE,IAAI,QAAQ;IACZ,gBAAgB,OAAO,CAAC,SAAA;QACpB,IAAI,MAAM,aAAa,IAAI,CAAC,SAAA;mBAAM,GAAG,cAAc,KAAK,MAAM,KAAK;;QACnE,IAAI,CAAC,SAAS,KAAK;YACf,QAAQ,OAAO,MAAM,IAAI,GAAG,MAAM,KAAK;QAC3C;IACJ;IACA,OAAO;AACX;AAGO,SAAS,cAAc,KAAK,EAAE,MAAM,EAAE,IAAI;IAC7C,IAAI,MAAM,MAAM,KAAK,OAAO;QACxB,OAAO,QAAQ,MAAM,IAAI,KAAK,SAAS,UAAU;IACrD,OAAO,IAAI,IAAA,wIAAY,EAAC,SAAS;QAC7B,OAAO,QAAQ,MAAM,IAAI,KAAK,SAAS,UAAU;IACrD,OAAO;QACH,IAAM,QAAQ,MAAM,CAAC,EAAE,CAAC,cAAc;QACtC,OAAO,uBAAuB,OAAO,MAAM,MAAM,IAAI;IACzD;AAEJ;AAEO,SAAS,iBAAiB,MAAM,EAAE,MAAM;IAC3C,OAAO,mBAAA,6BAAA,OAAQ,GAAG,CAAC,SAAA;QAEf,IAAM,cAAc,mBAAA,6BAAA,OAAQ,MAAM,CAAC,SAAA;mBAAK,EAAE,KAAK,CAAC,EAAE,KAAK,EAAE,EAAE;;QAC3D,IAAM,MAAM,wVAAK;YAAG,OAAO,cAAc,GAAG,aAAa;YAAO,WAAW,cAAc,GAAG,aAAa;;QACzG,OAAO;IACX;AACJ;AAEO,SAAS,YAAY,KAAK,EAAE,MAAM,EAAE,WAAW;IAClD,OAAO;QAAE,IAAI;QAAM,OAAO;QAAO,MAAM,IAAA,mIAAO;QAAI,MAAM;QAAI,SAAS;QAAM,UAAU;QAAQ,gBAAgB;QAAQ,OAAO;QAAI,MAAM;QAAa,OAAO,MAAM,CAAC,EAAE;IAAC;AAExK"}},
    {"offset": {"line": 807, "column": 0}, "map": {"version":3,"sources":["file:///home/tomer/VSCodeProjects/farm-manager-mobile-ui-next/src/ui/scout/ScoutingCard.js"],"sourcesContent":["import Card from '@mui/material/Card';\nimport CardHeader from '@mui/material/CardHeader';\nimport CardMedia from '@mui/material/CardMedia';\nimport CardContent from '@mui/material/CardContent';\nimport Avatar from '@mui/material/Avatar';\nimport IconButton from '@mui/material/IconButton';\nimport Typography from '@mui/material/Typography';\n\nimport { Edit, PestControl } from '@mui/icons-material';\nimport { getInfectionLevelColor } from './ScoutingUtil';\nimport { parseDate } from '../FarmUtil';\nimport { useSelector } from 'react-redux';\nimport { selectLang } from '../../features/app/appSlice';\n\n\n\nexport default function RecipeReviewCard({ scout, onEdit, index }) {\n\n    const text = useSelector(selectLang)\n\n    return (\n        <Card sx={{ margin: 2 }}>\n            <CardHeader\n                avatar={\n                    <Avatar sx={{ bgcolor: getInfectionLevelColor(scout.infectionLevel) }} aria-label=\"recipe\">\n                        <PestControl sx={{ color: 'white' }} />\n                    </Avatar>\n                }\n                action={\n                    <IconButton onClick={onEdit} aria-label=\"settings\">\n                        <Edit  />\n                    </IconButton>\n                }\n                title={scout.finding.name}\n                subheader={parseDate(scout.date)}\n\n            />\n            <CardMedia onClick={e=>console.log('CardMedia clicked')}\n        component=\"img\"\n        height=\"194\"\n        image={`/images/pest${index%2}.jpg`}\n        alt=\"Paella dish\"\n      />\n            <CardContent>\n                <Typography variant=\"body1\" color=\"text.secondary\" >\n                    {` ${text.location}:  ${text[scout.location]}`}\n                </Typography>\n                <Typography variant=\"body1\" color=\"text.secondary\" >\n                    {` ${text.infectionLevel}:  ${text[scout.infectionLevel]}`}\n                </Typography>\n                <Typography variant=\"body1\" color=\"text.secondary\"  >\n                    {` ${text.phenologicalStage}:  ${scout.stage.name}`}\n                </Typography>\n                <Typography variant=\"body1\" color=\"text.secondary\" >\n                    {` ${text.note}:  ${scout.note}`}\n                </Typography>\n                {/* <Typography variant=\"body2\" color=\"text.secondary\">\n                    {scout.note}\n                </Typography> */}\n            </CardContent>\n            {/* <CardActions disableSpacing>\n        <IconButton aria-label=\"add to favorites\">\n          <FavoriteIcon />\n        </IconButton>\n        <IconButton aria-label=\"share\">\n          <ShareIcon />\n        </IconButton>\n        <ExpandMore\n          expand={expanded}\n          onClick={handleExpandClick}\n          aria-expanded={expanded}\n          aria-label=\"show more\"\n        >\n          <ExpandMoreIcon />\n        </ExpandMore>\n      </CardActions> */}\n        </Card>\n    );\n}"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AAIe,SAAS,iBAAiB,KAAwB;QAAtB,QAAF,MAAE,OAAO,SAAT,MAAS,QAAQ,QAAjB,MAAiB;;IAEtD,IAAM,OAAO,IAAA,2KAAW,EAAC,mJAAU;IAEnC,qBACI,6LAAC,sKAAI;QAAC,IAAI;YAAE,QAAQ;QAAE;;0BAClB,6LAAC,kLAAU;gBACP,sBACI,6LAAC,0KAAM;oBAAC,IAAI;wBAAE,SAAS,IAAA,+JAAsB,EAAC,MAAM,cAAc;oBAAE;oBAAG,cAAW;8BAC9E,cAAA,6LAAC,8KAAW;wBAAC,IAAI;4BAAE,OAAO;wBAAQ;;;;;;;;;;;gBAG1C,sBACI,6LAAC,kLAAU;oBAAC,SAAS;oBAAQ,cAAW;8BACpC,cAAA,6LAAC,uKAAI;;;;;;;;;;gBAGb,OAAO,MAAM,OAAO,CAAC,IAAI;gBACzB,WAAW,IAAA,qIAAS,EAAC,MAAM,IAAI;;;;;;0BAGnC,6LAAC,gLAAS;gBAAC,SAAS,SAAA;2BAAG,QAAQ,GAAG,CAAC;;gBACvC,WAAU;gBACV,QAAO;gBACP,OAAO,AAAC,eAAsB,OAAR,QAAM,GAAE;gBAC9B,KAAI;;;;;;0BAEA,6LAAC,oLAAW;;kCACR,6LAAC,kLAAU;wBAAC,SAAQ;wBAAQ,OAAM;kCAC7B,AAAC,IAAsB,OAAnB,KAAK,QAAQ,EAAC,OAA0B,OAArB,IAAI,CAAC,MAAM,QAAQ,CAAC;;;;;;kCAEhD,6LAAC,kLAAU;wBAAC,SAAQ;wBAAQ,OAAM;kCAC7B,AAAC,IAA4B,OAAzB,KAAK,cAAc,EAAC,OAAgC,OAA3B,IAAI,CAAC,MAAM,cAAc,CAAC;;;;;;kCAE5D,6LAAC,kLAAU;wBAAC,SAAQ;wBAAQ,OAAM;kCAC7B,AAAC,IAA+B,OAA5B,KAAK,iBAAiB,EAAC,OAAsB,OAAjB,MAAM,KAAK,CAAC,IAAI;;;;;;kCAErD,6LAAC,kLAAU;wBAAC,SAAQ;wBAAQ,OAAM;kCAC7B,AAAC,IAAkB,OAAf,KAAK,IAAI,EAAC,OAAgB,OAAX,MAAM,IAAI;;;;;;;;;;;;;;;;;;AAwBlD;GA9DwB;;QAEP,2KAAW;;;KAFJ"}},
    {"offset": {"line": 970, "column": 0}, "map": {"version":3,"sources":["file:///home/tomer/VSCodeProjects/farm-manager-mobile-ui-next/src/ui/scout/ScoutingFieldPoint.js"],"sourcesContent":["import { useState } from 'react';\nimport Dialog from '@mui/material/Dialog';\nimport { AppBar, Box, DialogContent, Fab, IconButton, Toolbar, Typography } from '@mui/material';\nimport { useSelector } from 'react-redux';\nimport { selectCurrentYear, selectLang } from '../../features/app/appSlice';\nimport { Close, Edit } from '@mui/icons-material';\nimport { isArrayEmpty, isMobile } from '../FarmUtil';\nimport ScoutingForm from './ScoutingForm';\nimport { parseISO } from 'date-fns';\nimport { newScouting, SCOUT_TYPES } from './ScoutingUtil';\nimport ScoutingCard from './ScoutingCard';\nimport { grey } from '@mui/material/colors';\nimport AddIcon from '@mui/icons-material/Add';\nimport FieldPointDialog from '../point/FieldPointDialog';\n\nconst ScoutingFieldPoint = ({ open, point, scouts, handleClose, stages, setPoint }) => {\n  const currentYear = useSelector(selectCurrentYear)\n\n  const text = useSelector(selectLang)\n  const [scout, setScout] = useState(null);//isArrayEmpty(scouts) ? newScouting(point, stages, currentYear) : null );\n  const [editPoint, setEditPoint] = useState(false);\n\n  const handleCloseEditPoint = (action, e) => {\n    setEditPoint(false);\n    if (action === 'delete') {\n      handleClose(null);\n    } else if ((action === 'save')) {\n      setPoint(e);\n    }\n\n  }\n\n  const emptyScouts = isArrayEmpty(scouts);\n  console.log('emptyScouts', emptyScouts, scouts)\n  return (\n\n    <Box >\n      <Dialog fullScreen={isMobile()} fullWidth={!isMobile()} open={open}>\n        <AppBar sx={{ position: 'relative' }} elevation={0}>\n          <Toolbar>\n            <Typography sx={{ ml: 2, flex: 1 }} variant=\"h6\" component=\"div\">\n              {`${text.waypoint}: ${point.name}`}\n            </Typography>\n            <IconButton\n              edge=\"start\"\n              onClick={() => setEditPoint(true)}\n              color=\"inherit\"\n              aria-label=\"done\"\n            >\n              <Edit />\n            </IconButton>\n            <Box margin={1}></Box>\n            <IconButton\n              edge=\"start\"\n              onClick={() => handleClose(null)}\n              color=\"inherit\"\n              aria-label=\"done\"\n            >\n              <Close />\n            </IconButton>\n          </Toolbar>\n        </AppBar>\n        <DialogContent sx={{ padding: 0, bgcolor: grey[100], minHeight: 150 }}  >\n          {scouts.map((e, index) => {\n            return (\n              <ScoutingCard key={e.id} scout={e} index={index} onEdit={() => setScout(e)} />\n            )\n          })}\n        </DialogContent>\n        {point.active && <Fab onClick={() => setScout(newScouting(point, stages, currentYear))}\n          sx={{ position: 'fixed', bottom: 30, right: 30 }}\n          color=\"primary\" aria-label=\"add\">\n          <AddIcon />\n        </Fab>}\n      </Dialog>\n      {scout && <ScoutingForm open={true} defaultValues={{ ...scout, date: scout.id ? parseISO(scout.date) : scout.date, qty: scout.qty ? scout.qty : '' }} handleClose={() => setScout(null)} />}\n      {editPoint && <FieldPointDialog open={editPoint} deletable={isArrayEmpty(scouts)} defaultValues={point} handleClose={handleCloseEditPoint} types={SCOUT_TYPES} />}\n    </Box>\n  );\n\n}\nexport default ScoutingFieldPoint;\n"],"names":[],"mappings":";;;;;;;;;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;AAEA,IAAM,qBAAqB;QAAG,aAAA,MAAM,cAAA,OAAO,eAAA,QAAQ,oBAAA,aAAa,eAAA,QAAQ,iBAAA;;IACtE,IAAM,cAAc,IAAA,2KAAW,EAAC,0JAAiB;IAEjD,IAAM,OAAO,IAAA,2KAAW,EAAC,mJAAU;IACnC,IAA0B,qLAAA,IAAA,yKAAQ,EAAC,WAA5B,QAAmB,cAAZ,WAAY,cAAe,0EAA0E;IACnH,IAAkC,sLAAA,IAAA,yKAAQ,EAAC,YAApC,YAA2B,eAAhB,eAAgB;IAElC,IAAM,uBAAuB,SAAC,QAAQ;QACpC,aAAa;QACb,IAAI,WAAW,UAAU;YACvB,YAAY;QACd,OAAO,IAAK,WAAW,QAAS;YAC9B,SAAS;QACX;IAEF;IAEA,IAAM,cAAc,IAAA,wIAAY,EAAC;IACjC,QAAQ,GAAG,CAAC,eAAe,aAAa;IACxC,qBAEE,6LAAC,kMAAG;;0BACF,6LAAC,0KAAM;gBAAC,YAAY,IAAA,oIAAQ;gBAAI,WAAW,CAAC,IAAA,oIAAQ;gBAAI,MAAM;;kCAC5D,6LAAC,8MAAM;wBAAC,IAAI;4BAAE,UAAU;wBAAW;wBAAG,WAAW;kCAC/C,cAAA,6LAAC,kNAAO;;8CACN,6LAAC,8NAAU;oCAAC,IAAI;wCAAE,IAAI;wCAAG,MAAM;oCAAE;oCAAG,SAAQ;oCAAK,WAAU;8CACxD,AAAC,GAAoB,OAAlB,KAAK,QAAQ,EAAC,MAAe,OAAX,MAAM,IAAI;;;;;;8CAElC,6LAAC,8NAAU;oCACT,MAAK;oCACL,SAAS;+CAAM,aAAa;;oCAC5B,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC,uKAAI;;;;;;;;;;8CAEP,6LAAC,kMAAG;oCAAC,QAAQ;;;;;;8CACb,6LAAC,8NAAU;oCACT,MAAK;oCACL,SAAS;+CAAM,YAAY;;oCAC3B,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC,wKAAK;;;;;;;;;;;;;;;;;;;;;kCAIZ,6LAAC,0OAAa;wBAAC,IAAI;4BAAE,SAAS;4BAAG,SAAS,wMAAI,CAAC,IAAI;4BAAE,WAAW;wBAAI;kCACjE,OAAO,GAAG,CAAC,SAAC,GAAG;4BACd,qBACE,6LAAC,gJAAY;gCAAY,OAAO;gCAAG,OAAO;gCAAO,QAAQ;2CAAM,SAAS;;+BAArD,EAAE,EAAE;;;;;wBAE3B;;;;;;oBAED,MAAM,MAAM,kBAAI,6LAAC,kMAAG;wBAAC,SAAS;mCAAM,SAAS,IAAA,oJAAW,EAAC,OAAO,QAAQ;;wBACvE,IAAI;4BAAE,UAAU;4BAAS,QAAQ;4BAAI,OAAO;wBAAG;wBAC/C,OAAM;wBAAU,cAAW;kCAC3B,cAAA,6LAAC,sKAAO;;;;;;;;;;;;;;;;YAGX,uBAAS,6LAAC,gJAAY;gBAAC,MAAM;gBAAM,eAAe,wVAAK;oBAAO,MAAM,MAAM,EAAE,GAAG,IAAA,6MAAQ,EAAC,MAAM,IAAI,IAAI,MAAM,IAAI;oBAAE,KAAK,MAAM,GAAG,GAAG,MAAM,GAAG,GAAG;;gBAAM,aAAa;2BAAM,SAAS;;;;;;;YACjL,2BAAa,6LAAC,oJAAgB;gBAAC,MAAM;gBAAW,WAAW,IAAA,wIAAY,EAAC;gBAAS,eAAe;gBAAO,aAAa;gBAAsB,OAAO,oJAAW;;;;;;;;;;;;AAInK;GAjEM;;QACgB,2KAAW;QAElB,2KAAW;;;KAHpB;uCAkES"}}]
}